<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air Pollution Health Records</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        .navbar {
            background: #3498db;
            padding: 1rem 2rem;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 20px;
        }

        .alert-banner {
            background: #ff6b6b;
            color: white;
            padding: 1rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .record-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 2rem;
        }

        .record-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .record-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #eee;
        }

        .aqi-meter {
            margin: 1rem 0;
            height: 10px;
            background: #eee;
            border-radius: 5px;
            overflow: hidden;
        }

        .aqi-level {
            height: 100%;
            background: linear-gradient(to right, green, yellow, red);
            transition: width 0.3s;
        }

        .symptoms-list {
            list-style: circle inside;
            margin: 1rem 0;
        }

        .add-record-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 1rem;
        }

        .stats-panel {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            background: white;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            margin: 50px auto;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <h1>AIR </h1>
        <ul class="nav-links">
            <li><a href="index-one-page.html">Home</a></li>
            <li><a href="health-assessment-tracker.html">Assessment</a></li>
            <li><a href="air-pollution-tracker.html">Records</a></li>
            <li><a href="#contact">Contact</a></li>
        </ul>
    </nav>

    <div class="container">
        <div id="alertsSection"></div>

        <button class="add-record-btn"  onclick="openModal()">Add New Record</button>

        <div class="stats-panel">
            <h2>Weekly Statistics</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <h3>Average AQI</h3>
                    <p id="avgAqi">Loading...</p>
                </div>
                <div class="stat-item">
                    <h3>Symptom Frequency</h3>
                    <p id="symptomFreq">Loading...</p>
                </div>
                <div class="stat-item">
                    <h3>Risk Level</h3>
                    <p id="riskLevel">Loading...</p>
                </div>
            </div>
        </div>

        <div id="recordsGrid" class="record-grid"></div>
    </div>

    <div id="recordModal" class="modal">
        <div class="modal-content">
            <h2>Add New Health Record</h2>
            <form id="recordForm">
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="recordDate" required>
                </div>
                <div class="form-group">
                    <label>Current AQI Level</label>
                    <input type="number" id="aqiLevel" required min="0" max="500">
                </div>
                <div class="form-group">
                    <label>Symptoms</label>
                    <select id="symptoms" multiple>
                        <option value="cough">Coughing</option>
                        <option value="breathing">Breathing Difficulty</option>
                        <option value="irritation">Eye Irritation</option>
                        <option value="headache">Headache</option>
                        <option value="none">None</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Time Spent Outdoors (hours)</label>
                    <input type="number" id="outdoorTime" required min="0" max="24">
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <input type="text" id="notes">
                </div>
                <button type="submit" class="add-record-btn">Save Record</button>
                <button type="button" onclick="closeModal()" style="margin-left: 10px;">Cancel</button>
            </form>
        </div>
    </div>

    <script>
        // Sample data
        let healthRecords = [
            {
                date: '2025-01-22',
                aqi: 156,
                symptoms: ['cough', 'irritation'],
                outdoorTime: 3,
                notes: 'High pollution day'
            },
            {
                date: '2025-01-23',
                aqi: 142,
                symptoms: ['breathing'],
                outdoorTime: 2,
                notes: 'Used mask outdoors'
            }
        ];

        let alerts = [
            {
                id: 1,
                message: 'Schedule consultation due to persistent symptoms',
                urgent: true
            }
        ];

        // Render alerts
        function renderAlerts() {
            const alertsSection = document.getElementById('alertsSection');
            alertsSection.innerHTML = alerts.map(alert => `
                <div class="alert-banner" ${alert.urgent ? 'style="background: #dc3545;"' : ''}>
                    <span>${alert.message}</span>
                    <button onclick="dismissAlert(${alert.id})" style="background: none; border: none; color: white; cursor: pointer;">
                        âœ•
                    </button>
                </div>
            `).join('');
        }

        // Render health records
        function renderRecords() {
            const recordsGrid = document.getElementById('recordsGrid');
            recordsGrid.innerHTML = healthRecords.map(record => `
                <div class="record-card">
                    <div class="record-header">
                        <strong>${new Date(record.date).toLocaleDateString()}</strong>
                        <span>AQI: ${record.aqi}</span>
                    </div>
                    <div class="aqi-meter">
                        <div class="aqi-level" style="width: ${(record.aqi / 500) * 100}%"></div>
                    </div>
                    <div>
                        <h4>Symptoms:</h4>
                        <ul class="symptoms-list">
                            ${record.symptoms.map(s => `<li>${s}</li>`).join('')}
                        </ul>
                        <p>Outdoor Time: ${record.outdoorTime} hours</p>
                        <p>Notes: ${record.notes}</p>
                    </div>
                </div>
            `).join('');
        }

        // Update statistics
        function updateStats() {
            const avgAqi = healthRecords.reduce((sum, record) => sum + record.aqi, 0) / healthRecords.length;
            document.getElementById('avgAqi').textContent = Math.round(avgAqi);

            const symptomCount = healthRecords.reduce((count, record) => count + record.symptoms.length, 0);
            document.getElementById('symptomFreq').textContent = `${symptomCount} reported`;

            const riskLevel = avgAqi > 150 ? 'High' : avgAqi > 100 ? 'Moderate' : 'Low';
            document.getElementById('riskLevel').textContent = riskLevel;
        }

        function dismissAlert(id) {
            alerts = alerts.filter(alert => alert.id !== id);
            renderAlerts();
        }

        function openModal() {
            document.getElementById('recordModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('recordModal').style.display = 'none';
        }

        // Handle form submission
        document.getElementById('recordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newRecord = {
                date: document.getElementById('recordDate').value,
                aqi: parseInt(document.getElementById('aqiLevel').value),
                symptoms: Array.from(document.getElementById('symptoms').selectedOptions).map(opt => opt.value),
                outdoorTime: parseInt(document.getElementById('outdoorTime').value),
                notes: document.getElementById('notes').value
            };

            healthRecords.push(newRecord);
            
            // Check if consultation needed
            if (newRecord.aqi > 150 || newRecord.symptoms.length > 2) {
                alerts.push({
                    id: alerts.length + 1,
                    message: 'High risk detected. Schedule consultation recommended.',
                    urgent: true
                });
            }

            renderRecords();
            renderAlerts();
            updateStats();
            closeModal();
            this.reset();
        });

        // Initial render
        renderAlerts();
        renderRecords();
        updateStats();
    </script>
</body>
</html>
